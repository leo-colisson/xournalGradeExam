# Xournal GradeExam plugin

This [xournal](https://xournalpp.github.io) plugin aims to help teachers to quickly correct and export student work of any kind (exams, homeworks…). Are are the most important features:
- You can correct "free-form" exams, i.e. you don't need to ask students to write their answers in a fixed position.
- We provide tools to join multiple PDF into a single one and to "cut" scans of double page A4 = A3 documents into single-page A4 documents since this plugin expects to start with a single PDF containing all documents to grade. Scanning all exams can be done really quickly, notably using the fact that most professional printers can scan piles of A3 documents in a few seconds, otherwise you can still use a (e.g. guillotine) paper cutter to turn double page documents into single page, or take photos of the double page exam (maybe longer).
- You can either grade in points or in percentage.
- We allow easy export of the grade in a CSV that you can import in Excel/Libre office. You can specify for each question the maximum score used for instance when grading in percentage.
- Grades can be exported in a pre-defined order based on an existing list of student, e.g. copy/pasted from an existing reference Excel file.
- We provide tools to quickly identify the beginning of each exam and assign it to the corresponding student, for instance using a reference list of students.
- We provide shortcuts to quickly move to the next question to grade, either by going to the last graded question (most of the time the next question will be located right after), or if you pre-created questions with empty score where students wrote their answers, it will move to the smallest question that has no score.
- It is a xournal plugin, meaning that you can annotate PDF with the very reach-feature xournal PDF editor as usual, including with graphic tablets.
- Deal with homeworks done in team of multiple students

## Installation

- First, **install a really recent version of Xournal** to include [this PR merged on 2026/02/6](https://github.com/xournalpp/xournalpp/pull/7035) or export will be extremely slow and you may lack some features. We do our best to support older versions of Xournal lacking the needed API, but it is extremely slow notably when exporting since we need to navigate all the document, and we also can't support all wanted features for instance to skip students whose current question has already been corrected.
- Then, download the files in this repo (technically only `plugin.ini` and `main.lua` are needed), e.g. by downloading [the zip archive](https://github.com/leo-colisson/xournalGradeExam/archive/refs/heads/main.zip) and decompressing them at the root of the folder `/home/<user>/.config/xournalpp/plugins/gradeExam/` on Linux (so at the end you should have the files `/home/<user>/.config/xournalpp/plugins/gradeExam/{plugin.ini,main.lua}`, make sure to create the folders as they won't exist by default), `/Users/<user>/.config/xournalpp/gradeExam/` on MacOS, and `C:\Users\<user>\AppData\Local\xournalpp\gradeExam\` on Windows.
- To use the features to join PDF and decompose double pages scanned PDF into single pages, you should [install `python`](https://www.python.org/downloads/) and the `pypdf` dependency, e.g. by typing `python3 -m pip install pypdf` in a terminal (if you are on windows first start the `cmd` or `powershell` program to type commands).
- To use the features to quickly assign a student to its exam, you need to install `rofi` on Linux, [`wlines.exe` on windows](https://github.com/JerwuQu/wlines) (not tested, please give me returns), and [`choose` on MacOS](https://github.com/chipsenkbeil/choose). To install `wlines.exe` on windows, you can copy the downloaded file to an arbitrary folder, and change the `PATH` environment variable as [described here](https://learn.microsoft.com/en-us/previous-versions/office/developer/sharepoint-2010/ee537574(v=office.14)) to add this folder so that our plugin knows where to find it. **If you are too lazy to install these dependencies**, you can also simply manually type the name of the student (use TAB or `|` to separate student ID, first name, last name…) and we will do our best to match it with the reference list when exporting.

## Usage

Our plugin is simple and does nothing magic: everything is stored in a simple text area so that you can anotate/read/share your exams even without any installed plugin (it would just be longer to write them and navigate in the document, hence this plugin).

To benefit the most from the plugin, we recommend the following workflow:
1. First, make sure to have all exams presented in a single PDF file. For this we provide multiple ways to do that:
    - First I usually scan all my exams (unless of course if they come in digital form): for this I first manually unfold all my student exams (written on double pages) into a large pile of A3 documents and I use the printer of my university that can also quickly scan piles of large double page (A3) documents like most professional printers.
    - If the exams are spread across multiple files (e.g. because they came in digital form or if you scanned them in multiple batches) you can assemble all PDF in the current folder by clicking on `Plugins > GradeExam: assemble`. The path of the resulting file is shown once produced and no warning is shown if a file with the same name already exists.
    - Then if needed you should "unbook" the scanned double page into regular A4-like documents. For this, just click the menu entry named like `Plugins > GradeExam: Unbook`, and it will put the newly unbooked PDF `*_unbook.pdf` next to the current PDF (check the message at the end for the exact path). Warning, if the file already exists it will be overwritten without warnings.
2. (optional) If you already have an existing **reference list of students** (e.g. from a template Excel file that you need to fill), we advise you to copy/paste its content in a text area starting with `*students:` + a newline, into a new empty page (to create the page, first pick an arbitrary page model by clicking the arrow next to the `+` button, then click the `+` button, and put the newly created page before others by right clicking the page on the left menu and `move up`). Feel free to copy multiple columns (e.g student ID, first name, last name…), they will be turned into TAB (you can also use `|` instead of TAB), they will be re-exported, and they will help with matching names if you add this list only after correcting. This list will help when linking students to their exam later. Moreover, when exporting, we export grades following the order of this list, hence it is very easy to copy/paste grades back to the template you need to give back to the scolarity.
5. (optional) You can also add **reference grades** like `1.3 ~> 2` (aka *scale grades*) on new blank pages before the first exam (*preamble*), possibly multiple separated by newlines, to specify that the question `1.3` can have a maximum of 2 points: this helps e.g. when exporting in percentage mode and this also allows to specify how to order grades when exporting or navigating. If needed you can add this list later but navigating between grades may be a bit less acurate since we can't know for instance if we finished to correct a given exercice or not etc. These grades will be exported in the first line of the CSV.
6. Then you must start to identify at the beginning of each exam the **name of the student(s)** that wrote this exam:
    - If you gave a reference list of students (see before), you can do this very quickly by clicking on `Plugins > Add student` or press the shortcut key written next to it and a menu will appear allowing you to select the name of the current student that will then be written at the top of the page.
    - If you have not (yet) a reference list of students (or if you don't want to install the dependency to open the menu), you can also manually add a text `*:` directly followed by the name of the student. The name can contain arbitrary columns (student ID, first name, last name…) separated with TAB or the pipe character `|`. This way `*:4242 | Alice | Dupont` would be a valid student name with ID `4242` that you can add. Columns will be exported as such, and they also help to match the student with the optional reference list of students when exporting.

    You can also correct, e.g. the first question after attributing an exam to a student (see below). After attributing an exam, it is handy to go to the next exam by pressing the `Next page` key a few times, but you can also scroll there of course.
7. Then, **grades** are added in each exam next to the question they refer to, and the question name is separated from the given points via `~>` (faking an arrow without using too common symbols) so that writing `1.3 ~> 2` means that you gave 2 points to question 1.3. The points can either be **regular points** or a **percentage** like `1.3 ~> 100` to give all points, depending on the export mode, as for now you can't mix points and percentages in the same document. Multiple grades can be added in the same text area if they are separated by newlines. So far, xournal++ lacks an appropriate Lua API to add text on click, so you need to manually create this text until this API is available (I plan to give it a try soonish). In the meantime I just copy something like `1.3 ~>` and for each student I paste this text into a new text area and type the grade right after. Since I correct question per question I just need to copy the text when starting to correct a new question. Note that if the student has not written questions in the order specified in the subject (e.g. exercice 5 comes before exercice 4) you can add an empty grade like `5.1 ~>` next to the beginning of ex 5, skip the rest of it, and continue to grade exercice 4 as before, and when navigating later (and if you added the list of reference grades in the preamble), you will be moved directly to exercice 4 until you have finished its correction, and then when correcting question `5.1` you will be moved back to where the studert wrote their exercice 5.
8. After correcting one student, you want to **navigate to the next student/question to correct**. We provide a number a functions to navigate the document, but the most handy is certainly the function associated to the shortcut F4:
    - On modern xournal++ versions, this finds the student with the smallest uncorrected (= empty) grade and moves to it (if a question with empty points like `5.1 ~>` has been created as explained above if the student has not ordered questions properly) or to the question right before it otherwise (e.g. `4.6`) by searching for a text area that you added containing `4.6 ~> …`. This has a number of useful implications: if a student has not finished an exercice, you can just add grades setting the score `0` to all remaining questions of this exercice and this student will be skipped until you finish to correct this exercice. Also, for this to work better you should add a list of reference grades that will be used to know, for instance, that question 5.1 comes right after question 4.6, since e.g. otherwise we can't know if you should be moved to `5.1` (to start to correct exercice 5) or `4.6` (to correct a question `4.7`) after correcting the question `4.6`. 
    - On old xournal++ versions no API is provided to efficiently do that hence we just move to the last uncorrected grade of the next student.

    By default grades are sorted based on their order in the reference list of grades, and if not present we sort them naturally by splitting them at each dot and comparing their numeric valu if available and lexicagraphically otherwise, so that e.g. `1.5` comes before `10.4`. You can then grade this question as explained in the previous step, press F4 again to move to the next question to correct… and repeat until you have corrected all questions on all exams.
8. (optional) On the preamble (empty pages before the first exam) you can also add a text area starting with `*settings:` followed by a new line and a list of options (one per line) like `my option=my param` to **customize various aspects of this program**. For now we only provide one option `removeNoGradeCells` such that, if it is set to `removeNoGradeCells=true`, will export in the CSV any cell with no grade as an empty cell instead of writting a more visible `NO GRADE` text.
9. After correcting all students, you can **export the grades in a CSV file** by clicking on an entry named like `Plugins > GradeExam: export CSV` or `Plugins > GradeExam: export CSV (percentage)` if you graded each question in percent. A csv file named like `*_grades.csv` will be created with all grades, and a list of warning may be printed if it detected weird things (e.g. a student with two grades for the same question…). A warning is also shown for each page that has zero annotations to ensure that you have not skipped a page by mistake, so write a dummy text like `seen` on pages with no grade to ensure that it is not a forgotten page. **If the list of warning is too long** the `OK` button may be hidden, forbidding you from clicking it to dismiss the list of warnings. Just press the Enter key instead (all logs are also visible in a `.log` file created next to the document).
10. **Import this CSV** in your favorite spreadsheet editor (Excel, Libre Office Calc…). At least in Libre Office Calc, **make sure to select the `English` locale** when importing the CSV (otherwise it might be confused by grades with dots like `2.5` if your default locale expects comma-separated numbers) and click on a field named like `Evaluate formulas` since in percentage mode we use formula to allow you to later change the scale for each question in excel.
11. You can also **export the document into many PDF** (one for each student with the corresponding exam) by clicking on `Plugins > GradeExam: export PDF` (it will create a new folder containing all PDF). This way you can send their file to each student to allow them to see comments on their exams.

## TODOs and known issues

This plugin is already fairly usable but still under development: it has notably been poorly tested (especially on Windows & MacOS), so please report in the [Github issue tracker](https://github.com/leo-colisson/xournalGradeExam/issues) any bug you may encounter. We also have a list of remaining TODO to implement, if you are interested in one feature (listed here or not), feel free to drop a message in the above bug report to motivate me to code it quickly:
- Go backward
- Allow template to pre-position the elements
- Allow to specify that all remaining grades should be set to 0, or introduce `*end:`
- Automatically add the next grade when clicking or drawing in the margin. First, we need to implement in Xournal++ a way too add hooks to detect clicks, see [this discussion](https://github.com/xournalpp/xournalpp/discussions/7067). 
- Better documentation & vidéos
- The menu is a bit cluttered with many not-so-useful entries. Try to hide them in a submenu [if we find a way to do that with Xournal++](https://github.com/xournalpp/xournalpp/discussions/7119).
- Export without background to allow teacher to print comments over written exams (not sure how reliable this would be)
- Provide methods to automatically send emails with exams to each student, or to synchronize it automatically with Moodle, or to encrypt with a password so that all exams can be put on an arbitrary server.

## Related tools

- PDF4Teachers
- [CorrectExam](https://correctexam.github.io/)
